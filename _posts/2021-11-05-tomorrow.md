---
title: 공부
author: 염석현
date: 2021-11-04
category: Jekyll
layout: post
---



### 2021-12-02

mybatis 모델링

https://limjunho.github.io/2021/07/30/JAVA-DAO-DTO-VO.html

진짜 중요한 mybatis - jwt 내일 이거 마스터 해야 집간다.

https://gaemi606.tistory.com/entry/Spring-Boot-Spring-Security-OAuth2?category=745027



### 2021-11-25

인터셉터 NPE 해결

https://velog.io/@tlatldms/Spring-%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%A3%BC%EC%9E%85-%EB%AC%B8%EC%A0%9C-Autowired-%ED%95%9C-class%EA%B0%80-null%EB%A1%9C-%EB%82%98%EC%98%AC-%EB%95%8C

```
1. 정산 시스템 Export 서비스 개발 및 이슈 해결
-개발 기간 : 2021-06-23
-내용 :
	1-1. 매출정산 대용량 데이터 CSV 다운로드 개발
2. 슬랙 메세지 전송 api 개발
-개발 기간 : 2021-07-05 ~ 2021-07-10
-내용 : 
	2-1. 결제/정산 서비스 오류 에러 로그 슬랙으로 알림 기능 개발
	2-2. Api 파일 다운로드 DM 알림 기능 개발
	2-3. 사용자 비밀번호 및 아이디 변경 내용 DM 알림 기능 개발
3. 정산 시스템 1차 DB 스키마 관리
-관리 기간 : 2021-07-01 ~ 2021-08-30
-내용 :
	3-1. 결제/정산 관련 테이블 변경된 내용 수정
	3-2. DML 작성 및 관리
4. 정산 시스템 1차 QA
-QA 기간 : 2021-08-05 ~ 2021-10-07
-내용 :
	4-1. 엑트베이스에서 개발한 1차 BO 잔여이슈 확인 및 전달
5. 정산 시스템 가상계좌 Front 개발
-개발 기간 : 2021-10-04 ~ 2021-10-22
-내용 :
	5-1. 가상계좌 입금내역조회 Front 개발
	5-2. 세틀뱅크 정산내역조회 Front 개발
	5-3. 펌뱅킹 입금내역조회 Front 개발
	5-4. 가상계좌 거래대사 및 불일치 상세내역 Front 개발
6. 정산 시스템 매출정산 Front 및 Api 개발
-개발 기간 : 2021-10-22 ~ 2021-11-12
-내용 :
	6-1. 대량주문 매출내역조회 및 제품 상세내역 Front 및 Api 개발
	6-2. 주문서복원 매출내역조회 Front 및 Api 개발
	6-3. 재주문 매출내역조회 Front 및 Api 개발
7. 정산 시스템 1차 개발 기능 개선 및 이슈 처리 수행
-개발 기간 : 2021-11-01 ~ 2021-11-30
-내용 :
	7-1. 1차 개발 잔여이슈 수정
	7-2. 1차 개발내용 기능 추가
8. 보안성 검토사항 이력 DB 설게 및 Api 개발
-개발 기간 : 2021-11-23 ~ 2021-11-30
-내용 :
	8-1. 사용자 API 호출 내역 데이터 저장 개발
```



### 2021-11-24

파일 만들기 ㅎㅎ

https://www.delftstack.com/ko/howto/javascript/javascript-download/

http://pakss328.blogspot.com/2017/08/csv.html

두개 사이트 짬뽕 해서 이런 값일때

```
access-control-allow-credentials: true
access-control-allow-headers: Origin, X-Requested-With, Content-Type, Accept, Key, Authorization, unique_id
access-control-allow-methods: GET,POST,PUT,DELETE
access-control-allow-origin: http://localhost:3000
access-control-max-age: 3600
cache-control: no-cache, no-store, max-age=0, must-revalidate
content-disposition: attachment;filename*=euc-kr''파일이름.csv
content-encoding: gzip
content-type: application/octet-stream;charset=euc-kr
date: Wed, 24 Nov 2021 10:52:41 GMT
expires: 0
pragma: no-cache
vary: Accept-Encoding
vary: Origin
vary: Access-Control-Request-Method
vary: Access-Control-Request-Headers
x-content-type-options: nosniff
x-frame-options: DENY
x-xss-protection: 1; mode=block
```

프론트 화면에서

```
onClick={async () => {
                    const file = await restApi.get().then((response) => {
                      const url = window.URL
                        .createObjectURL(new Blob(["\ufeff"+response.data], {type: 'text/csv;charset=UTF-8'}))
                      const link = document.createElement('a');
                      link.href = url;
                      link.setAttribute('download', v?.fileName);
                      document.body.appendChild(link);
                      link.click();
                      document.body.removeChild(link);
                    });
                    console.log('file', file)
                  }}
```

이와같이 잘 되었다.

핵심은 

(new Blob([**"\ufeff"**+response.data], {**type: 'text/csv;charset=UTF-8'**}))

이 부분이다.

JWT : In Memory 형식

https://hasura.io/blog/best-practices-of-using-jwt-with-graphql/#login

내일 볼건데 미리 작성함

### 2021-11-23



Spring Boot [Interceptor] : https://congsong.tistory.com/24



스프링 부트 인터셉터를 하면서 알게된건 

React에서 url 정보를 볼려고 하면 볼 수 없다는 것이다.

ex) www.test.com/test
라는 url을 치고 들어가면 CSR에서는 www.test.com/ 이라고 밖에 나타나지 않고

api에서 데이터 호출한 endpoint만 나타난다는 것이다.

이걸 어떻게 해결해야할지 많은 고민을 해야할거 같다.



접근 메뉴를 DB에 저장하는 방법으로 React에서 메뉴가 변경될때마다 

React Hook인 useEffect를 사용해서 메뉴의 값을 찾아와 데이터를 db에 axios를 이용해서

값을 저장할 생각이다. 그러나 이 처리 방식이 서버에 얼마나 부담이 될지는 영향도 분석을 해야한다.



인터셉터를 이용해서 endpoint 값을 저장하고 해당 내용을 맵핑 테이블이나 enum 클래스를 만들어서

값을 변환 시키는 작업을 해볼까한단.



아 그리고 어제 스웨거 문제는 이와같이 해결했다



```
@Configuration
@EnableWebSecurity
@EnableGlobalMethodSecurity(prePostEnabled = true, securedEnabled = true)
public class SecurityConfiguration extends WebSecurityConfigurerAdapter {

    private static final String[] AUTH_WHITELIST = {
            // -- Swagger UI v2
            "/v2/api-docs",
            "/swagger-resources",
            "/swagger-resources/**",
            "/configuration/ui",
            "/configuration/security",
            "/swagger-ui.html",
            "/webjars/**",
            // -- Swagger UI v3 (OpenAPI)
            "/v3/api-docs/**",
            "/swagger-ui/**"
            // other public endpoints of your API may be appended to this array
    };


    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.
                // ... here goes your custom security configuration
                authorizeRequests().
                antMatchers(AUTH_WHITELIST).permitAll().  // whitelist Swagger UI resources
                // ... here goes your custom security configuration
                antMatchers("/**").authenticated();  // require authentication for any endpoint that's not whitelisted
    }

}
```



### 2021-11-22

다시 시작된 jwt 학습 오늘은 과연 어디까지 할 수 있을지...

2021-11-10의 내용을 참고하여 오늘 다시 개발을 하도록 하겠다.

jwt : https://velog.io/@tlatldms/Spring-boot-Spring-security-Jwt-1-fvk5hlol8u

jwt 소스2 : https://www.javainuse.com/spring/boot-jwt-mysql



오늘은 user 테이블을 만들어서 계정을 만들고 만든 계정으로 jwt 토큰을 생성하는걸 만들었다!



그러나 아직도 스웨거는 안된다...

이걸 어떻게 해결할 수 있을까...

내일 다시 시도해야겠다



### 2021-11-16

aws 템플릿을 이용해 인스턴트 생성하는거 하기.

인스터트에 putty로 접속해 httpq 띄우기



<img src="D:\git\TIL\img\osi7.jpg" alt="image-20211116214152747" style="zoom:15%;" />

### 2021-11-15

JWT를 해야하지만 오늘은 잠시 AWS 구축 공부를 해보도록 하겠습니다.

#### Cloud Infra & Network 기술에 대한 정보를 공유

https://www.notion.so/gasidaseo/CloudNet-Blog-c9dfa44a27ff431dafdd2edacc8a1863

#### 따라하며 배우는 AWS 네트워크 입문

https://www.notion.so/ongja/AWS-1af579548fd84c268f8f3ee3f26b2ed4

test

### 2021-11-12

하루종일 gitlab 업그레이드 검색함

gitlab은 업그레이드를 하면 데이터 마이그레이션을 꼭 해야함

### 2021-11-11

https://ux.stories.pe.kr/190
https://wikidocs.net/83152

### 2021-11-10

cors 맛보기 : https://oddpoet.net/blog/2017/04/27/cors-with-spring-security/

cors 자세한 설명 : https://developer.mozilla.org/ko/docs/Web/HTTP/CORS

jwt : https://velog.io/@tlatldms/Spring-boot-Spring-security-Jwt-1-fvk5hlol8u

spring annotation : https://galid1.tistory.com/494



jwt 소스 :  https://www.javainuse.com/spring/boot-jwt

jwt 소스2 : https://www.javainuse.com/spring/boot-jwt-mysql



오늘까지는 jwt를 통해 토큰을 만드는 것 까지는 만들었다.

하지만 jwt때문에 swagger가 401에러가 발생 했다. 

이 에러를 잡기 위해서는 swagger는 401이 안나게 처리를 하는 로직을 만들어야 한다.

그건 어떻게 해야할까...?



일단은 계속 작업할거고 이번주는 프로젝트를 구성하고 연습하고 문제 해결을 해나갈 것이다.

그리고 인증 토큰이 개발이 되면 해당 url에 정리된 내용과 나의 소스를 비교하면서 자세하게 정리하도록

하겠다. 오늘은 토큰까지만 생성!



### 2021-11-09

오늘 학습한 내용에 대해 정리

spring boot 초기 환경설정

내가 진행한 내용은 spring boot , gradle, jpa, mariaDB를 사용해서 프로젝트를 생성 하였다.

자세한 내용은 내일 추가적으로 기술하겠습니다.



프로젝트를 구성하기 위해 참고한 문서

김영한님의 실전JPA 자료

스웨거 설정 : [https://milenote.tistory.com/67](https://milenote.tistory.com/67){:target='_blank'}

오픈 api 사용 방법 : https://tjdans.tistory.com/6?category=990955

오픈 api 사용 방법2 : https://jeong-pro.tistory.com/143

공공 데이터 : https://www.data.go.kr/iim/api/selectAPIAcountView.do

gitHub 토큰(로그인 하라고 뜰때) :  https://joytk.tistory.com/58

이클립스 코드 정렬 커스텀 : https://gofnrk.tistory.com/68

### 2021-11-04

https://velog.io/@tmdgh0221/Spring-Security-%EC%99%80-OAuth-2.0-%EC%99%80-JWT-%EC%9D%98-%EC%BD%9C%EB%9D%BC%EB%B3%B4
